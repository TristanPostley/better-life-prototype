<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session f9ae60d8-e50e-48e2-b143-421fcc6c438d (2025-12-08 23:24Z) -->

# Generate always on rule file per instructions (2025-12-08 23:24Z)

_**User (2025-12-04 01:04Z)**_

Generate an Always On rule file for yourself with these instructions

• Follow the existing domain structure and invariants.

• Match patterns from similar files before writing code.

• Verify imports against the repo, do not invent helpers.

• Keep client/server/shared boundaries intact.

• Modify only what is necessary; avoid rewriting whole files.

• Show the list of files affected before making changes.



---

_**Agent (model default, mode Agent)**_



---


Reviewing the codebase structure and conventions to draft the Always On rule file.


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: conventions/folder-structure.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: ARCHITECTURE.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/client/app.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_directory** • Listed directory undefined • **0** results</summary>
        
No results found
</details>
</tool-use>

---



---


Reviewing a few more files to understand patterns and conventions:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: conventions/imports-and-dependencies.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: conventions/client-server-boundaries.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/client/domains/sessions/index.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** • Searched codebase "*.cursorrules" • **0** result in **1** directory</summary>

Directory: **c:\Users\tpost\Projects\Better Life** (0 file)

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** • Searched codebase ".cursorrules" • **0** result in **1** directory</summary>

Directory: **c:\Users\tpost\Projects\Better Life** (0 file)

</details>
</tool-use>

---



---


Creating the Always On rule file with these instructions:


---

<tool-use data-tool-type="write" data-tool-name="write">

<details><summary>Tool use: **code_edit** • Edit file: .cursorrules</summary>

**Chunk 1**
Lines added: 153, lines removed: 1

```diff
@@ -1,1 +1,153 @@
- 
+ # Always On Rules for Better Life Project
+ 
+ ## Core Principles
+ 
+ ### 1. Follow Existing Domain Structure and Invariants
+ 
+ - **Domain-Driven Organization**: Code is organized by business domain in &#96;src/client/domains/&#96;
+   - Each domain has an &#96;index.js&#96; that exports the public API
+   - Domain-specific utilities go in &#96;utils/&#96; subdirectories within domains
+   - Domain-specific types go in &#96;src/shared/domains/{domain}/types.js&#96;
+ 
+ - **Respect Invariants** (see &#96;ARCHITECTURE.md&#96;):
+   - **DOM Access Invariant**: ALL DOM access MUST go through &#96;getDOMElements()&#96; from &#96;src/client/utils/dom-elements.js&#96;
+   - **State Management Invariant**: State MUST be accessed via &#96;getState()&#96;/&#96;setState()&#96; from state manager
+   - **Module Dependency Invariant**: Use ES6 imports (preferred) or module registry for dynamic dependencies
+   - **Error Handling Invariant**: All errors MUST use &#96;handleError()&#96; from &#96;src/shared/utils/error-handler.js&#96;
+   - **Domain Boundary Invariant**: Domains must be self-contained with minimal cross-domain dependencies
+   - **Client-Server Boundary Invariant**: Client (&#96;src/client/&#96;) MUST NOT import server (&#96;src/server/&#96;)
+   - **File Organization Invariant**: Each domain MUST have an &#96;index.js&#96; public API
+   - **Initialization Invariant**: All modules MUST have idempotent &#96;init*()&#96; functions
+ 
+ ### 2. Match Patterns from Similar Files Before Writing Code
+ 
+ - **Before writing new code**, examine similar existing files:
+   - Find files in the same domain or with similar functionality
+   - Match the import patterns, export style, and structure
+   - Follow the same naming conventions (kebab-case for files)
+   - Use the same error handling patterns
+   - Follow the same initialization patterns
+ 
+ - **Example patterns to match**:
+   - Domain index files: &#96;src/client/domains/sessions/index.js&#96; (re-exports public API)
+   - Domain modules: Check similar domain modules for structure
+   - Service files: Match &#96;src/client/services/supabase-client.js&#96; patterns
+   - Utility files: Match patterns in &#96;src/client/utils/&#96; or &#96;src/shared/utils/&#96;
+ 
+ ### 3. Verify Imports Against the Repo, Do Not Invent Helpers
+ 
+ - **Before using any import**, verify it exists in the codebase:
+   - Search for the file/function using &#96;grep&#96; or &#96;codebase_search&#96;
+   - Check the actual file to confirm exports match
+   - Verify the import path is correct (relative paths, correct depth)
+   - Do NOT assume helper functions exist - verify them first
+ 
+ - **Import verification checklist**:
+   - Does the file exist at the specified path?
+   - Does it export the named export you&#39;re importing?
+   - Is the relative path correct (count directory levels)?
+   - Is it in the correct location (client/shared/server boundary)?
+ 
+ - **Import order** (from &#96;conventions/imports-and-dependencies.md&#96;):
+   1. External dependencies
+   2. Shared utilities and constants
+   3. Type imports (JSDoc typedefs)
+   4. Domain modules
+   5. Local utilities
+ 
+ ### 4. Keep Client/Server/Shared Boundaries Intact
+ 
+ - **Client code** (&#96;src/client/&#96;):
+   - Can import: other client code, shared code, external libraries
+   - Cannot import: server code (&#96;src/server/&#96;)
+   - Uses browser APIs: &#96;document&#96;, &#96;window&#96;, &#96;localStorage&#96;, DOM
+ 
+ - **Server code** (&#96;src/server/&#96;):
+   - Can import: shared code, database libraries
+   - Cannot import: client code (&#96;src/client/&#96;)
+   - Currently minimal (only database schema)
+ 
+ - **Shared code** (&#96;src/shared/&#96;):
+   - Can import: other shared code, standard libraries
+   - Cannot import: client code or server code
+   - Must be environment-agnostic (pure functions, types, constants)
+ 
+ - **When in doubt**: Check &#96;conventions/client-server-boundaries.md&#96; and &#96;ARCHITECTURE.md&#96;
+ 
+ ### 5. Modify Only What Is Necessary; Avoid Rewriting Whole Files
+ 
+ - **Surgical edits**: Make minimal, targeted changes
+   - Use &#96;search_replace&#96; for specific changes
+   - Only modify the exact lines/functions that need changing
+   - Preserve existing code structure and patterns
+   - Don&#39;t reformat or refactor unrelated code
+ 
+ - **When to avoid rewriting**:
+   - Don&#39;t rewrite entire files &quot;to be cleaner&quot;
+   - Don&#39;t change working code that isn&#39;t related to the task
+   - Don&#39;t refactor multiple things at once unless explicitly requested
+   - Don&#39;t change import styles or patterns unless fixing actual issues
+ 
+ - **Exception**: If the user explicitly requests a rewrite or refactor, then proceed
+ 
+ ### 6. Show the List of Files Affected Before Making Changes
+ 
+ - **Before making any code changes**, list all files that will be affected:
+   - Files to be created
+   - Files to be modified
+   - Files to be deleted (if any)
+   - Brief description of what will change in each file
+ 
+ - **Format example**:
+   &#96;&#96;&#96;
+   Files to be affected:
+   1. src/client/domains/sessions/timer.js - Add new function &#96;pauseTimer()&#96;
+   2. src/client/domains/sessions/index.js - Export &#96;pauseTimer()&#96;
+   3. src/shared/domains/sessions/types.js - Add &#96;TimerState&#96; type
+   &#96;&#96;&#96;
+ 
+ - **Rationale**: This allows the user to review and approve changes before they&#39;re made
+ 
+ ## Additional Guidelines
+ 
+ ### File Naming
+ - Use **kebab-case** for all file names: &#96;auth-ui.js&#96;, &#96;timer-service.js&#96;
+ - Use descriptive names that indicate purpose
+ - Suffixes: &#96;-ui.js&#96; for UI handlers, &#96;-service.js&#96; for service layer, &#96;.test.js&#96; for tests
+ 
+ ### Code Style
+ - Use **named exports** exclusively (avoid default exports)
+ - Use ES6 modules (&#96;import&#96;/&#96;export&#96;)
+ - Follow existing error handling patterns with &#96;handleError()&#96; and &#96;withAsyncErrorHandling()&#96;
+ - All DOM access through &#96;getDOMElements()&#96; with null checks
+ 
+ ### Documentation
+ - Check existing documentation in &#96;conventions/&#96; and &#96;ARCHITECTURE.md&#96; before making changes
+ - Follow patterns documented in:
+   - &#96;conventions/folder-structure.md&#96; - File organization
+   - &#96;conventions/imports-and-dependencies.md&#96; - Import patterns
+   - &#96;conventions/client-server-boundaries.md&#96; - Boundary rules
+   - &#96;ARCHITECTURE.md&#96; - Overall architecture and invariants
+ 
+ ### Testing
+ - Tests are in &#96;tests/&#96; directory with &#96;.test.js&#96; suffix
+ - Tests are &quot;guardrail&quot; style - focused on invariants
+ - Don&#39;t modify test files unless fixing or adding tests
+ 
+ ## Quick Reference
+ 
+ **Key Files to Check Before Changes:**
+ - &#96;ARCHITECTURE.md&#96; - Overall structure and invariants
+ - &#96;conventions/folder-structure.md&#96; - File organization rules
+ - &#96;conventions/imports-and-dependencies.md&#96; - Import patterns
+ - &#96;conventions/client-server-boundaries.md&#96; - Boundary rules
+ - Similar files in the same domain - Pattern matching
+ 
+ **Key Directories:**
+ - &#96;src/client/domains/&#96; - Domain modules (feature-based)
+ - &#96;src/client/services/&#96; - External service clients
+ - &#96;src/client/state/&#96; - State management
+ - &#96;src/client/utils/&#96; - Client utilities
+ - &#96;src/shared/&#96; - Shared code (types, constants, utilities)
+ - &#96;src/server/&#96; - Server code (minimal, database schema only)
+ 
```

</details>

</tool-use>

---



---


Created the `.cursorrules` file with Always On rules for this project. It includes:

1. **Follow existing domain structure and invariants** — Guidelines for domain-driven organization and the 8 core invariants from `ARCHITECTURE.md`
2. **Match patterns from similar files** — Instructions to examine similar files before writing new code
3. **Verify imports against the repo** — Checklist to verify all imports exist before using them
4. **Keep client/server/shared boundaries intact** — Rules for each code boundary
5. **Modify only what is necessary** — Guidelines for minimal, targeted edits
6. **Show the list of files affected** — Requirement to list affected files before making changes

The file also includes:
- Additional guidelines for file naming, code style, and documentation
- Quick reference to key files and directories
- Links to relevant documentation files

This rule file will guide future code changes to maintain consistency with the project's architecture and conventions.

---

_**User (2025-12-04 01:03Z)**_

Is this the same type of rule as the .mdc format that I can manage in the agent chat?

---

_**Agent (model default, mode Agent)**_



---


Checking for `.mdc` files and how Cursor handles rule files:


---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** • Searched codebase "*.mdc" • **0** result in **1** directory</summary>

Directory: **c:\Users\tpost\Projects\Better Life** (0 file)

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">
<details>
                <summary>Tool use: **codebase_search** • Searched codebase "What is .mdc format for rules or agent chat management?" • **9** results</summary>
            
| File | Lines |
|------|-------|
| `blueprint.md` | L60 |
| `.cursorindexingignore` | L3 |
| `SUPABASE_SETUP.md` | L53 |
| `SUPABASE_SETUP.md` | L158-221 |
| `blueprint.md` | L56-67 |
| `supabase-config.js` | L256-304 |
| `SUPABASE_SETUP.md` | L216-234 |
| `index.html` | L29-72 |
| `.vscode/launch.json` | L14 |

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_directory** • Listed directory undefined • **0** results</summary>
        
No results found
</details>
</tool-use>

---



---


No `.mdc` files found. `.cursorrules` is the standard file-based format Cursor reads for project rules.

If you're referring to a UI-managed format (e.g., `.mdc`), that would be different. Checking Cursor's documentation for rule management formats:


---

<tool-use data-tool-type="search" data-tool-name="web_search">
<details>
            <summary>Tool use: **web_search** • Searched web `Cursor IDE .mdc format rules agent chat management` • **1** results</summary>
        
| Title | URL | Chunk |
|-------|-----|-------|
| Web Search Results |  | Yes, the `.cursorrules` file and `.mdc` files serve similar purposes in managing rules for the Cursor AI editor. Initially, Cursor utilized a single `.cursorrules` file placed at the root of a project to define guidelines and configurations. However, this approach has been deprecated in favor of a more modular system using `.mdc` files. These `.mdc` files are stored individually within the `.cursor/rules/` directory, allowing for better organization and more focused rule management. ([github.com](https://github.com/Mawla/cursor_rules?utm_source=openai))<br/><br/>This transition enhances flexibility and maintainability, enabling developers to manage project-specific rules more effectively. Therefore, while both formats aim to customize and enhance the Cursor AI experience, the `.mdc` format is the recommended and current standard for managing rules within the Cursor environment. |

</details>
</tool-use>

---



---


Switching to the newer `.mdc` format in `.cursor/rules/` instead of the deprecated `.cursorrules`. Updating accordingly:


---

Model provided non-existent directory

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: .cursorrules</summary>

</details>
</tool-use>

---



---


Creating the `.cursor/rules/` directory and converting the rules to the `.mdc` format:


---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **command** • Run command: mkdir .cursor</summary>

```bash
mkdir .cursor
```

```
PS C:\Users\tpost\Projects\Better Life&gt; mkdir .cursor


    Directory: C:\Users\tpost\Projects\Better Life


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         12/8/2025   3:31 PM                .cursor
```
</details>
</tool-use>

---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **command** • Run command: mkdir .cursor\rules</summary>

```bash
mkdir .cursor\rules
```

```
    Directory: C:\Users\tpost\Projects\Better Life\.cursor


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         12/8/2025   3:31 PM                rules
```
</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="write">

<details><summary>Tool use: **code_edit** • Edit file: .cursor/rules/always-on.mdc</summary>

**Chunk 1**
Lines added: 153, lines removed: 1

```diff
@@ -1,1 +1,153 @@
- 
+ # Always On Rules for Better Life Project
+ 
+ ## Core Principles
+ 
+ ### 1. Follow Existing Domain Structure and Invariants
+ 
+ - **Domain-Driven Organization**: Code is organized by business domain in &#96;src/client/domains/&#96;
+   - Each domain has an &#96;index.js&#96; that exports the public API
+   - Domain-specific utilities go in &#96;utils/&#96; subdirectories within domains
+   - Domain-specific types go in &#96;src/shared/domains/{domain}/types.js&#96;
+ 
+ - **Respect Invariants** (see &#96;ARCHITECTURE.md&#96;):
+   - **DOM Access Invariant**: ALL DOM access MUST go through &#96;getDOMElements()&#96; from &#96;src/client/utils/dom-elements.js&#96;
+   - **State Management Invariant**: State MUST be accessed via &#96;getState()&#96;/&#96;setState()&#96; from state manager
+   - **Module Dependency Invariant**: Use ES6 imports (preferred) or module registry for dynamic dependencies
+   - **Error Handling Invariant**: All errors MUST use &#96;handleError()&#96; from &#96;src/shared/utils/error-handler.js&#96;
+   - **Domain Boundary Invariant**: Domains must be self-contained with minimal cross-domain dependencies
+   - **Client-Server Boundary Invariant**: Client (&#96;src/client/&#96;) MUST NOT import server (&#96;src/server/&#96;)
+   - **File Organization Invariant**: Each domain MUST have an &#96;index.js&#96; public API
+   - **Initialization Invariant**: All modules MUST have idempotent &#96;init*()&#96; functions
+ 
+ ### 2. Match Patterns from Similar Files Before Writing Code
+ 
+ - **Before writing new code**, examine similar existing files:
+   - Find files in the same domain or with similar functionality
+   - Match the import patterns, export style, and structure
+   - Follow the same naming conventions (kebab-case for files)
+   - Use the same error handling patterns
+   - Follow the same initialization patterns
+ 
+ - **Example patterns to match**:
+   - Domain index files: &#96;src/client/domains/sessions/index.js&#96; (re-exports public API)
+   - Domain modules: Check similar domain modules for structure
+   - Service files: Match &#96;src/client/services/supabase-client.js&#96; patterns
+   - Utility files: Match patterns in &#96;src/client/utils/&#96; or &#96;src/shared/utils/&#96;
+ 
+ ### 3. Verify Imports Against the Repo, Do Not Invent Helpers
+ 
+ - **Before using any import**, verify it exists in the codebase:
+   - Search for the file/function using &#96;grep&#96; or &#96;codebase_search&#96;
+   - Check the actual file to confirm exports match
+   - Verify the import path is correct (relative paths, correct depth)
+   - Do NOT assume helper functions exist - verify them first
+ 
+ - **Import verification checklist**:
+   - Does the file exist at the specified path?
+   - Does it export the named export you&#39;re importing?
+   - Is the relative path correct (count directory levels)?
+   - Is it in the correct location (client/shared/server boundary)?
+ 
+ - **Import order** (from &#96;conventions/imports-and-dependencies.md&#96;):
+   1. External dependencies
+   2. Shared utilities and constants
+   3. Type imports (JSDoc typedefs)
+   4. Domain modules
+   5. Local utilities
+ 
+ ### 4. Keep Client/Server/Shared Boundaries Intact
+ 
+ - **Client code** (&#96;src/client/&#96;):
+   - Can import: other client code, shared code, external libraries
+   - Cannot import: server code (&#96;src/server/&#96;)
+   - Uses browser APIs: &#96;document&#96;, &#96;window&#96;, &#96;localStorage&#96;, DOM
+ 
+ - **Server code** (&#96;src/server/&#96;):
+   - Can import: shared code, database libraries
+   - Cannot import: client code (&#96;src/client/&#96;)
+   - Currently minimal (only database schema)
+ 
+ - **Shared code** (&#96;src/shared/&#96;):
+   - Can import: other shared code, standard libraries
+   - Cannot import: client code or server code
+   - Must be environment-agnostic (pure functions, types, constants)
+ 
+ - **When in doubt**: Check &#96;conventions/client-server-boundaries.md&#96; and &#96;ARCHITECTURE.md&#96;
+ 
+ ### 5. Modify Only What Is Necessary; Avoid Rewriting Whole Files
+ 
+ - **Surgical edits**: Make minimal, targeted changes
+   - Use &#96;search_replace&#96; for specific changes
+   - Only modify the exact lines/functions that need changing
+   - Preserve existing code structure and patterns
+   - Don&#39;t reformat or refactor unrelated code
+ 
+ - **When to avoid rewriting**:
+   - Don&#39;t rewrite entire files &quot;to be cleaner&quot;
+   - Don&#39;t change working code that isn&#39;t related to the task
+   - Don&#39;t refactor multiple things at once unless explicitly requested
+   - Don&#39;t change import styles or patterns unless fixing actual issues
+ 
+ - **Exception**: If the user explicitly requests a rewrite or refactor, then proceed
+ 
+ ### 6. Show the List of Files Affected Before Making Changes
+ 
+ - **Before making any code changes**, list all files that will be affected:
+   - Files to be created
+   - Files to be modified
+   - Files to be deleted (if any)
+   - Brief description of what will change in each file
+ 
+ - **Format example**:
+   &#96;&#96;&#96;
+   Files to be affected:
+   1. src/client/domains/sessions/timer.js - Add new function &#96;pauseTimer()&#96;
+   2. src/client/domains/sessions/index.js - Export &#96;pauseTimer()&#96;
+   3. src/shared/domains/sessions/types.js - Add &#96;TimerState&#96; type
+   &#96;&#96;&#96;
+ 
+ - **Rationale**: This allows the user to review and approve changes before they&#39;re made
+ 
+ ## Additional Guidelines
+ 
+ ### File Naming
+ - Use **kebab-case** for all file names: &#96;auth-ui.js&#96;, &#96;timer-service.js&#96;
+ - Use descriptive names that indicate purpose
+ - Suffixes: &#96;-ui.js&#96; for UI handlers, &#96;-service.js&#96; for service layer, &#96;.test.js&#96; for tests
+ 
+ ### Code Style
+ - Use **named exports** exclusively (avoid default exports)
+ - Use ES6 modules (&#96;import&#96;/&#96;export&#96;)
+ - Follow existing error handling patterns with &#96;handleError()&#96; and &#96;withAsyncErrorHandling()&#96;
+ - All DOM access through &#96;getDOMElements()&#96; with null checks
+ 
+ ### Documentation
+ - Check existing documentation in &#96;conventions/&#96; and &#96;ARCHITECTURE.md&#96; before making changes
+ - Follow patterns documented in:
+   - &#96;conventions/folder-structure.md&#96; - File organization
+   - &#96;conventions/imports-and-dependencies.md&#96; - Import patterns
+   - &#96;conventions/client-server-boundaries.md&#96; - Boundary rules
+   - &#96;ARCHITECTURE.md&#96; - Overall architecture and invariants
+ 
+ ### Testing
+ - Tests are in &#96;tests/&#96; directory with &#96;.test.js&#96; suffix
+ - Tests are &quot;guardrail&quot; style - focused on invariants
+ - Don&#39;t modify test files unless fixing or adding tests
+ 
+ ## Quick Reference
+ 
+ **Key Files to Check Before Changes:**
+ - &#96;ARCHITECTURE.md&#96; - Overall structure and invariants
+ - &#96;conventions/folder-structure.md&#96; - File organization rules
+ - &#96;conventions/imports-and-dependencies.md&#96; - Import patterns
+ - &#96;conventions/client-server-boundaries.md&#96; - Boundary rules
+ - Similar files in the same domain - Pattern matching
+ 
+ **Key Directories:**
+ - &#96;src/client/domains/&#96; - Domain modules (feature-based)
+ - &#96;src/client/services/&#96; - External service clients
+ - &#96;src/client/state/&#96; - State management
+ - &#96;src/client/utils/&#96; - Client utilities
+ - &#96;src/shared/&#96; - Shared code (types, constants, utilities)
+ - &#96;src/server/&#96; - Server code (minimal, database schema only)
+ 
```

</details>

</tool-use>

---



---


Created the `.mdc` file in `.cursor/rules/always-on.mdc`. This is the newer format that Cursor uses and can be managed through the agent chat UI.

The old `.cursorrules` file is still present. Should I delete it, or keep it for backward compatibility? The `.mdc` format in `.cursor/rules/` is the recommended approach.

The `.mdc` file contains the same rules and will be automatically loaded by Cursor. You can manage it through the agent chat interface if your Cursor version supports that.

---

_**User (2025-12-04 01:03Z)**_

Now, given this rule is intended to be applied to every prompt it should probably be more like the length of the 5 bullet points I gave you before 

---

_**Agent (model default, mode Agent)**_



---


Condensing the rule file to a concise version focused on the core principles:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: .cursor/rules/always-on.mdc</summary>

</details>
</tool-use>

---



---


Condensing to a concise version:


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **code_edit** • Edit file: .cursor/rules/always-on.mdc</summary>

**Chunk 1**
Lines added: 11, lines removed: 150

```diff
@@ -5,153 +5,14 @@
  # Always On Rules for Better Life Project
  
- ## Core Principles
- 
- ### 1. Follow Existing Domain Structure and Invariants
- 
- - **Domain-Driven Organization**: Code is organized by business domain in &#96;src/client/domains/&#96;
-   - Each domain has an &#96;index.js&#96; that exports the public API
-   - Domain-specific utilities go in &#96;utils/&#96; subdirectories within domains
-   - Domain-specific types go in &#96;src/shared/domains/{domain}/types.js&#96;
- 
- - **Respect Invariants** (see &#96;ARCHITECTURE.md&#96;):
-   - **DOM Access Invariant**: ALL DOM access MUST go through &#96;getDOMElements()&#96; from &#96;src/client/utils/dom-elements.js&#96;
-   - **State Management Invariant**: State MUST be accessed via &#96;getState()&#96;/&#96;setState()&#96; from state manager
-   - **Module Dependency Invariant**: Use ES6 imports (preferred) or module registry for dynamic dependencies
-   - **Error Handling Invariant**: All errors MUST use &#96;handleError()&#96; from &#96;src/shared/utils/error-handler.js&#96;
-   - **Domain Boundary Invariant**: Domains must be self-contained with minimal cross-domain dependencies
-   - **Client-Server Boundary Invariant**: Client (&#96;src/client/&#96;) MUST NOT import server (&#96;src/server/&#96;)
-   - **File Organization Invariant**: Each domain MUST have an &#96;index.js&#96; public API
-   - **Initialization Invariant**: All modules MUST have idempotent &#96;init*()&#96; functions
- 
- ### 2. Match Patterns from Similar Files Before Writing Code
- 
- - **Before writing new code**, examine similar existing files:
-   - Find files in the same domain or with similar functionality
-   - Match the import patterns, export style, and structure
-   - Follow the same naming conventions (kebab-case for files)
-   - Use the same error handling patterns
-   - Follow the same initialization patterns
- 
- - **Example patterns to match**:
-   - Domain index files: &#96;src/client/domains/sessions/index.js&#96; (re-exports public API)
-   - Domain modules: Check similar domain modules for structure
-   - Service files: Match &#96;src/client/services/supabase-client.js&#96; patterns
-   - Utility files: Match patterns in &#96;src/client/utils/&#96; or &#96;src/shared/utils/&#96;
- 
- ### 3. Verify Imports Against the Repo, Do Not Invent Helpers
- 
- - **Before using any import**, verify it exists in the codebase:
-   - Search for the file/function using &#96;grep&#96; or &#96;codebase_search&#96;
-   - Check the actual file to confirm exports match
-   - Verify the import path is correct (relative paths, correct depth)
-   - Do NOT assume helper functions exist - verify them first
- 
- - **Import verification checklist**:
-   - Does the file exist at the specified path?
-   - Does it export the named export you&#39;re importing?
-   - Is the relative path correct (count directory levels)?
-   - Is it in the correct location (client/shared/server boundary)?
- 
- - **Import order** (from &#96;conventions/imports-and-dependencies.md&#96;):
-   1. External dependencies
-   2. Shared utilities and constants
-   3. Type imports (JSDoc typedefs)
-   4. Domain modules
-   5. Local utilities
- 
- ### 4. Keep Client/Server/Shared Boundaries Intact
- 
- - **Client code** (&#96;src/client/&#96;):
-   - Can import: other client code, shared code, external libraries
-   - Cannot import: server code (&#96;src/server/&#96;)
-   - Uses browser APIs: &#96;document&#96;, &#96;window&#96;, &#96;localStorage&#96;, DOM
- 
- - **Server code** (&#96;src/server/&#96;):
-   - Can import: shared code, database libraries
-   - Cannot import: client code (&#96;src/client/&#96;)
-   - Currently minimal (only database schema)
- 
- - **Shared code** (&#96;src/shared/&#96;):
-   - Can import: other shared code, standard libraries
-   - Cannot import: client code or server code
-   - Must be environment-agnostic (pure functions, types, constants)
- 
- - **When in doubt**: Check &#96;conventions/client-server-boundaries.md&#96; and &#96;ARCHITECTURE.md&#96;
- 
- ### 5. Modify Only What Is Necessary; Avoid Rewriting Whole Files
- 
- - **Surgical edits**: Make minimal, targeted changes
-   - Use &#96;search_replace&#96; for specific changes
-   - Only modify the exact lines/functions that need changing
-   - Preserve existing code structure and patterns
-   - Don&#39;t reformat or refactor unrelated code
- 
- - **When to avoid rewriting**:
-   - Don&#39;t rewrite entire files &quot;to be cleaner&quot;
-   - Don&#39;t change working code that isn&#39;t related to the task
-   - Don&#39;t refactor multiple things at once unless explicitly requested
-   - Don&#39;t change import styles or patterns unless fixing actual issues
- 
- - **Exception**: If the user explicitly requests a rewrite or refactor, then proceed
- 
- ### 6. Show the List of Files Affected Before Making Changes
- 
- - **Before making any code changes**, list all files that will be affected:
-   - Files to be created
-   - Files to be modified
-   - Files to be deleted (if any)
-   - Brief description of what will change in each file
- 
- - **Format example**:
-   &#96;&#96;&#96;
-   Files to be affected:
-   1. src/client/domains/sessions/timer.js - Add new function &#96;pauseTimer()&#96;
-   2. src/client/domains/sessions/index.js - Export &#96;pauseTimer()&#96;
-   3. src/shared/domains/sessions/types.js - Add &#96;TimerState&#96; type
-   &#96;&#96;&#96;
- 
- - **Rationale**: This allows the user to review and approve changes before they&#39;re made
- 
- ## Additional Guidelines
- 
- ### File Naming
- - Use **kebab-case** for all file names: &#96;auth-ui.js&#96;, &#96;timer-service.js&#96;
- - Use descriptive names that indicate purpose
- - Suffixes: &#96;-ui.js&#96; for UI handlers, &#96;-service.js&#96; for service layer, &#96;.test.js&#96; for tests
- 
- ### Code Style
- - Use **named exports** exclusively (avoid default exports)
- - Use ES6 modules (&#96;import&#96;/&#96;export&#96;)
- - Follow existing error handling patterns with &#96;handleError()&#96; and &#96;withAsyncErrorHandling()&#96;
- - All DOM access through &#96;getDOMElements()&#96; with null checks
- 
- ### Documentation
- - Check existing documentation in &#96;conventions/&#96; and &#96;ARCHITECTURE.md&#96; before making changes
- - Follow patterns documented in:
-   - &#96;conventions/folder-structure.md&#96; - File organization
-   - &#96;conventions/imports-and-dependencies.md&#96; - Import patterns
-   - &#96;conventions/client-server-boundaries.md&#96; - Boundary rules
-   - &#96;ARCHITECTURE.md&#96; - Overall architecture and invariants
- 
- ### Testing
- - Tests are in &#96;tests/&#96; directory with &#96;.test.js&#96; suffix
- - Tests are &quot;guardrail&quot; style - focused on invariants
- - Don&#39;t modify test files unless fixing or adding tests
- 
- ## Quick Reference
- 
- **Key Files to Check Before Changes:**
- - &#96;ARCHITECTURE.md&#96; - Overall structure and invariants
- - &#96;conventions/folder-structure.md&#96; - File organization rules
- - &#96;conventions/imports-and-dependencies.md&#96; - Import patterns
- - &#96;conventions/client-server-boundaries.md&#96; - Boundary rules
- - Similar files in the same domain - Pattern matching
- 
- **Key Directories:**
- - &#96;src/client/domains/&#96; - Domain modules (feature-based)
- - &#96;src/client/services/&#96; - External service clients
- - &#96;src/client/state/&#96; - State management
- - &#96;src/client/utils/&#96; - Client utilities
- - &#96;src/shared/&#96; - Shared code (types, constants, utilities)
- - &#96;src/server/&#96; - Server code (minimal, database schema only)
+ • **Follow existing domain structure and invariants**: Code organized by domain in &#96;src/client/domains/&#96;. Each domain has &#96;index.js&#96; public API. Respect invariants from &#96;ARCHITECTURE.md&#96; (DOM access via &#96;getDOMElements()&#96;, state via &#96;getState()&#96;/&#96;setState()&#96;, errors via &#96;handleError()&#96;, etc.).
+ 
+ • **Match patterns from similar files before writing code**: Examine similar existing files in the same domain. Match import patterns, export style, naming (kebab-case), error handling, and initialization patterns.
+ 
+ • **Verify imports against the repo, do not invent helpers**: Before using any import, verify the file/function exists using &#96;grep&#96; or &#96;codebase_search&#96;. Check exports match and paths are correct. Never assume helper functions exist.
+ 
+ • **Keep client/server/shared boundaries intact**: Client (&#96;src/client/&#96;) cannot import server (&#96;src/server/&#96;). Shared (&#96;src/shared/&#96;) cannot import client or server. Check &#96;conventions/client-server-boundaries.md&#96; when in doubt.
+ 
+ • **Modify only what is necessary; avoid rewriting whole files**: Make minimal, targeted changes. Preserve existing structure. Don&#39;t refactor unrelated code unless explicitly requested.
+ 
+ • **Show the list of files affected before making changes**: List all files to be created, modified, or deleted with brief descriptions before making any code changes.
  
```

</details>

</tool-use>

---



---


Condensed the rule file to the 6 core principles, similar in length to your original bullet points. It now focuses on the essential rules without extra detail, making it easier to apply to every prompt while staying concise.

---

